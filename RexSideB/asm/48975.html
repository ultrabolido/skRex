<!DOCTYPE html>
<html>
<head>
<title>Rex: Routine at BF4F</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../rex.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/scr/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="48971.html">BF4B</a>
</td>
<td class="up">Up: <a href="../maps/all.html#48975">Map</a></td>
<td class="next">
Next: <a href="49473.html">C141</a>
</td>
</tr>
</table>
<div class="description">BF4F: Draw enemies (2/2)</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="48200.html#48881">BEF1</a>.
</div>
<div class="paragraph">
Create projectile for PLANT
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="48975"></span>BF4F</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="2">Save <span class="register">AF</span> and <span class="register">DE</span></td>
</tr>
<tr>
<td class="address-1"><span id="48976"></span>BF50</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="address-1"><span id="48977"></span>BF51</td>
<td class="instruction">CALL <a href="46412.html#46518">$B5B6</a></td>
<td class="comment-1" rowspan="1">Configure weapon sound and check for weapon free slot</td>
</tr>
<tr>
<td class="address-1"><span id="48980"></span>BF54</td>
<td class="instruction">LD A,(IX+$00)</td>
<td class="comment-1" rowspan="3">Set x-position for the projectile</td>
</tr>
<tr>
<td class="address-1"><span id="48983"></span>BF57</td>
<td class="instruction">SUB $08</td>
</tr>
<tr>
<td class="address-1"><span id="48985"></span>BF59</td>
<td class="instruction">LD ($A22C),A</td>
</tr>
<tr>
<td class="address-1"><span id="48988"></span>BF5C</td>
<td class="instruction">LD A,$08</td>
<td class="comment-1" rowspan="1">Set increment of y-position for the projectile</td>
</tr>
<tr>
<td class="address-1"><span id="48990"></span>BF5E</td>
<td class="instruction">CALL <a href="46548.html">$B5D4</a></td>
<td class="comment-1" rowspan="1">Create a new projectile</td>
</tr>
<tr>
<td class="address-1"><span id="48993"></span>BF61</td>
<td class="instruction">LD (IY+$0B),$87</td>
<td class="comment-1" rowspan="1">Set projectile type to seed plant</td>
</tr>
<tr>
<td class="address-1"><span id="48997"></span>BF65</td>
<td class="instruction">LD (IY+$0C),$00</td>
<td class="comment-1" rowspan="1">Set projectile trajectory index</td>
</tr>
<tr>
<td class="address-1"><span id="49001"></span>BF69</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore <span class="register">DE</span></td>
</tr>
<tr>
<td class="address-1"><span id="49002"></span>BF6A</td>
<td class="instruction">LD (IY+$04),E</td>
<td class="comment-1" rowspan="1">Set x-delta for the projectile</td>
</tr>
<tr>
<td class="address-1"><span id="49005"></span>BF6D</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore <span class="register">AF</span></td>
</tr>
<tr>
<td class="address-1"><span id="49006"></span>BF6E</td>
<td class="instruction">SLA A</td>
<td class="comment-1" rowspan="3">Computes index into table of trajectory addresses</td>
</tr>
<tr>
<td class="address-1"><span id="49008"></span>BF70</td>
<td class="instruction">SLA A</td>
</tr>
<tr>
<td class="address-1"><span id="49010"></span>BF72</td>
<td class="instruction">LD (IY+$0E),A</td>
</tr>
<tr>
<td class="address-1"><span id="49013"></span>BF75</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49014"></span>
<div class="comments">
<div class="paragraph">
PLANT is closing
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49014"></span>BF76</td>
<td class="instruction">LD L,(IX+$04)</td>
<td class="comment-1" rowspan="7">Point to the next graphic data</td>
</tr>
<tr>
<td class="address-1"><span id="49017"></span>BF79</td>
<td class="instruction">LD H,(IX+$05)</td>
</tr>
<tr>
<td class="address-1"><span id="49020"></span>BF7C</td>
<td class="instruction">LD DE,$0020</td>
</tr>
<tr>
<td class="address-1"><span id="49023"></span>BF7F</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="49024"></span>BF80</td>
<td class="instruction">SBC HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="49026"></span>BF82</td>
<td class="instruction">LD (IX+$04),L</td>
</tr>
<tr>
<td class="address-1"><span id="49029"></span>BF85</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49032"></span>BF88</td>
<td class="instruction">DEC (IX+$12)</td>
<td class="comment-1" rowspan="1">Decrement state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49035"></span>BF8B</td>
<td class="instruction">JP NZ,<a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy if counter is not zero</td>
</tr>
<tr>
<td class="address-1"><span id="49038"></span>BF8E</td>
<td class="instruction">LD (IX+$11),$00</td>
<td class="comment-1" rowspan="1">Set state to standing-by</td>
</tr>
<tr>
<td class="address-1"><span id="49042"></span>BF92</td>
<td class="instruction">JP <a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49045"></span>
<div class="comments">
<div class="paragraph">
PLANT is standing-by
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49045"></span>BF95</td>
<td class="instruction">CALL <a href="42269.html">$A51D</a></td>
<td class="comment-1" rowspan="1">Generate a random number</td>
</tr>
<tr>
<td class="address-1"><span id="49048"></span>BF98</td>
<td class="instruction">CP $0A</td>
<td class="comment-1" rowspan="2">if number greater than 10 then jump back and process next enemy</td>
</tr>
<tr>
<td class="address-1"><span id="49050"></span>BF9A</td>
<td class="instruction">JP NC,<a href="48200.html#48473">$BD59</a></td>
</tr>
<tr>
<td class="address-1"><span id="49053"></span>BF9D</td>
<td class="instruction">LD (IX+$11),$01</td>
<td class="comment-1" rowspan="1">Set Plant opening</td>
</tr>
<tr>
<td class="address-1"><span id="49057"></span>BFA1</td>
<td class="instruction">LD (IX+$12),$06</td>
<td class="comment-1" rowspan="1">Set state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49061"></span>BFA5</td>
<td class="instruction">JP <a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49064"></span>
<div class="comments">
<div class="paragraph">
Handle BULB
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49064"></span>BFA8</td>
<td class="instruction">LD A,(IX+$11)</td>
<td class="comment-1" rowspan="1">Check status indicator</td>
</tr>
<tr>
<td class="address-1"><span id="49067"></span>BFAB</td>
<td class="instruction">OR A</td>
<td class="comment-1" rowspan="1">BULB state is standing-by?</td>
</tr>
<tr>
<td class="address-1"><span id="49068"></span>BFAC</td>
<td class="instruction">JP Z,$C01F</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="49071"></span>BFAF</td>
<td class="instruction">CP $01</td>
<td class="comment-1" rowspan="1">BULB state is expanding?</td>
</tr>
<tr>
<td class="address-1"><span id="49073"></span>BFB1</td>
<td class="instruction">JP Z,$BFBC</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="49076"></span>BFB4</td>
<td class="instruction">CP $02</td>
<td class="comment-1" rowspan="1">BULB state is retracting?</td>
</tr>
<tr>
<td class="address-1"><span id="49078"></span>BFB6</td>
<td class="instruction">JP Z,$C000</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="49081"></span>BFB9</td>
<td class="instruction">JP <a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and continue processing the next enemy</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49084"></span>
<div class="comments">
<div class="paragraph">
BULB is expanding
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49084"></span>BFBC</td>
<td class="instruction">LD L,(IX+$04)</td>
<td class="comment-1" rowspan="6">Point to the next graphic data for the sprite</td>
</tr>
<tr>
<td class="address-1"><span id="49087"></span>BFBF</td>
<td class="instruction">LD H,(IX+$05)</td>
</tr>
<tr>
<td class="address-1"><span id="49090"></span>BFC2</td>
<td class="instruction">LD DE,$0020</td>
</tr>
<tr>
<td class="address-1"><span id="49093"></span>BFC5</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="49094"></span>BFC6</td>
<td class="instruction">LD (IX+$04),L</td>
</tr>
<tr>
<td class="address-1"><span id="49097"></span>BFC9</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49100"></span>BFCC</td>
<td class="instruction">DEC (IX+$12)</td>
<td class="comment-1" rowspan="1">Decrement state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49103"></span>BFCF</td>
<td class="instruction">JP NZ,<a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy if state change counter is not zero</td>
</tr>
<tr>
<td class="address-1"><span id="49106"></span>BFD2</td>
<td class="instruction">LD (IX+$11),$02</td>
<td class="comment-1" rowspan="1">Set state to retract BULB</td>
</tr>
<tr>
<td class="address-1"><span id="49110"></span>BFD6</td>
<td class="instruction">LD (IX+$12),$05</td>
<td class="comment-1" rowspan="1">Set state change counter</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49114"></span>
<div class="comments">
<div class="paragraph">
BULB fires weapon
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="49114"></span>BFDA</td>
<td class="instruction">LD A,$04</td>
<td class="comment-1" rowspan="2">Set the projectile type to spray</td>
</tr>
<tr>
<td class="address-1"><span id="49116"></span>BFDC</td>
<td class="instruction">LD ($A1ED),A</td>
</tr>
<tr>
<td class="address-1"><span id="49119"></span>BFDF</td>
<td class="instruction">CALL <a href="46412.html#46518">$B5B6</a></td>
<td class="comment-1" rowspan="1">Configure weapon sound and check for weapon free slot</td>
</tr>
<tr>
<td class="address-1"><span id="49122"></span>BFE2</td>
<td class="instruction">CALL <a href="49473.html">$C141</a></td>
<td class="comment-1" rowspan="1">Configure projectile | extra-left</td>
</tr>
<tr>
<td class="address-1"><span id="49125"></span>BFE5</td>
<td class="instruction">CALL <a href="46412.html#46518">$B5B6</a></td>
<td class="comment-1" rowspan="1">Configure weapon sound and check for weapon free slot</td>
</tr>
<tr>
<td class="address-1"><span id="49128"></span>BFE8</td>
<td class="instruction">CALL <a href="49473.html#49499">$C15B</a></td>
<td class="comment-1" rowspan="1">Configure projectile | left</td>
</tr>
<tr>
<td class="address-1"><span id="49131"></span>BFEB</td>
<td class="instruction">CALL <a href="46412.html#46518">$B5B6</a></td>
<td class="comment-1" rowspan="1">Configure weapon sound and check for weapon free slot</td>
</tr>
<tr>
<td class="address-1"><span id="49134"></span>BFEE</td>
<td class="instruction">CALL <a href="49473.html#49537">$C181</a></td>
<td class="comment-1" rowspan="1">Configure projectile | middle</td>
</tr>
<tr>
<td class="address-1"><span id="49137"></span>BFF1</td>
<td class="instruction">CALL <a href="46412.html#46518">$B5B6</a></td>
<td class="comment-1" rowspan="1">Configure weapon sound and check for weapon free slot</td>
</tr>
<tr>
<td class="address-1"><span id="49140"></span>BFF4</td>
<td class="instruction">CALL <a href="49473.html#49563">$C19B</a></td>
<td class="comment-1" rowspan="1">Configure projectile | right</td>
</tr>
<tr>
<td class="address-1"><span id="49143"></span>BFF7</td>
<td class="instruction">CALL <a href="46412.html#46518">$B5B6</a></td>
<td class="comment-1" rowspan="1">Configure weapon sound and check for weapon free slot</td>
</tr>
<tr>
<td class="address-1"><span id="49146"></span>BFFA</td>
<td class="instruction">CALL <a href="49473.html#49587">$C1B3</a></td>
<td class="comment-1" rowspan="1">Configure projectile | extra-right</td>
</tr>
<tr>
<td class="address-1"><span id="49149"></span>BFFD</td>
<td class="instruction">JP <a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49152"></span>
<div class="comments">
<div class="paragraph">
BULB is retracting
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49152"></span>C000</td>
<td class="instruction">LD L,(IX+$04)</td>
<td class="comment-1" rowspan="7">Point to the next graphic data for the sprite</td>
</tr>
<tr>
<td class="address-1"><span id="49155"></span>C003</td>
<td class="instruction">LD H,(IX+$05)</td>
</tr>
<tr>
<td class="address-1"><span id="49158"></span>C006</td>
<td class="instruction">LD DE,$0020</td>
</tr>
<tr>
<td class="address-1"><span id="49161"></span>C009</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="address-1"><span id="49162"></span>C00A</td>
<td class="instruction">SBC HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="49164"></span>C00C</td>
<td class="instruction">LD (IX+$04),L</td>
</tr>
<tr>
<td class="address-1"><span id="49167"></span>C00F</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49170"></span>C012</td>
<td class="instruction">DEC (IX+$12)</td>
<td class="comment-1" rowspan="1">Decrement state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49173"></span>C015</td>
<td class="instruction">JP NZ,<a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy if state change counter is not zero</td>
</tr>
<tr>
<td class="address-1"><span id="49176"></span>C018</td>
<td class="instruction">LD (IX+$11),$00</td>
<td class="comment-1" rowspan="1">Set state to stand-by BULB</td>
</tr>
<tr>
<td class="address-1"><span id="49180"></span>C01C</td>
<td class="instruction">JP <a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49183"></span>
<div class="comments">
<div class="paragraph">
BULB is standing-by
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49183"></span>C01F</td>
<td class="instruction">CALL <a href="42269.html">$A51D</a></td>
<td class="comment-1" rowspan="1">Computes a random number</td>
</tr>
<tr>
<td class="address-1"><span id="49186"></span>C022</td>
<td class="instruction">CP $0A</td>
<td class="comment-1" rowspan="2">Jump back and process next enemy if random number is greater than 10</td>
</tr>
<tr>
<td class="address-1"><span id="49188"></span>C024</td>
<td class="instruction">JP NC,<a href="48200.html#48473">$BD59</a></td>
</tr>
<tr>
<td class="address-1"><span id="49191"></span>C027</td>
<td class="instruction">LD (IX+$11),$01</td>
<td class="comment-1" rowspan="1">Change state to expanding</td>
</tr>
<tr>
<td class="address-1"><span id="49195"></span>C02B</td>
<td class="instruction">LD (IX+$12),$05</td>
<td class="comment-1" rowspan="1">Set state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49199"></span>C02F</td>
<td class="instruction">JP <a href="48200.html#48473">$BD59</a></td>
<td class="comment-1" rowspan="1">Jump back and process next enemy</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49202"></span>
<div class="comments">
<div class="paragraph">
Handle Foot Man dying 6
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49202"></span>C032</td>
<td class="instruction">LD A,(IX+$11)</td>
<td class="comment-1" rowspan="1">Set <span class="register">A</span> to state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49205"></span>C035</td>
<td class="instruction">CP $04</td>
<td class="comment-1" rowspan="1">counter is 4?</td>
</tr>
<tr>
<td class="address-1"><span id="49207"></span>C037</td>
<td class="instruction">JP NZ,$C04C</td>
<td class="comment-1" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="address-1"><span id="49210"></span>C03A</td>
<td class="instruction">LD HL,$AF7A</td>
<td class="comment-1" rowspan="3">Set address for animation offsets of dying foot man</td>
</tr>
<tr>
<td class="address-1"><span id="49213"></span>C03D</td>
<td class="instruction">LD (IX+$0A),L</td>
</tr>
<tr>
<td class="address-1"><span id="49216"></span>C040</td>
<td class="instruction">LD (IX+$0B),H</td>
</tr>
<tr>
<td class="address-1"><span id="49219"></span>C043</td>
<td class="instruction">LD HL,$82B8</td>
<td class="comment-1" rowspan="3">Set graphic data for dying Foot man 7</td>
</tr>
<tr>
<td class="address-1"><span id="49222"></span>C046</td>
<td class="instruction">LD (IX+$16),L</td>
</tr>
<tr>
<td class="address-1"><span id="49225"></span>C049</td>
<td class="instruction">LD (IX+$17),H</td>
</tr>
<tr>
<td class="address-2"><span id="49228"></span>C04C</td>
<td class="instruction">DEC (IX+$11)</td>
<td class="comment-1" rowspan="1">Decrement state change counter</td>
</tr>
<tr>
<td class="address-1"><span id="49231"></span>C04F</td>
<td class="instruction">JP NZ,<a href="48200.html#48423">$BD27</a></td>
<td class="comment-1" rowspan="1">If not zero jump back and continue to process other enemies</td>
</tr>
<tr>
<td class="address-1"><span id="49234"></span>C052</td>
<td class="instruction">LD (IX+$09),$07</td>
<td class="comment-1" rowspan="1">Set enemy type to FOOT MAN dying 7</td>
</tr>
<tr>
<td class="address-1"><span id="49238"></span>C056</td>
<td class="instruction">JP <a href="48200.html#48423">$BD27</a></td>
<td class="comment-1" rowspan="1">Jump back and continue to process other enemies</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49241"></span>
<div class="comments">
<div class="paragraph">
Handle explosion and configure gift: bubble, smartbomb or question
</div>
<div class="paragraph">
Handle debris expansion
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49241"></span>C059</td>
<td class="instruction">LD HL,$AA57</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the offset of positions for debris 1</td>
</tr>
<tr>
<td class="address-1"><span id="49244"></span>C05C</td>
<td class="instruction">CALL <a href="49758.html">$C25E</a></td>
<td class="comment-1" rowspan="1">Handle debris movement and draw it</td>
</tr>
<tr>
<td class="address-1"><span id="49247"></span>C05F</td>
<td class="instruction">LD HL,$AA67</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the offset of positions for debris 2</td>
</tr>
<tr>
<td class="address-1"><span id="49250"></span>C062</td>
<td class="instruction">CALL <a href="49758.html">$C25E</a></td>
<td class="comment-1" rowspan="1">Handle debris movement and draw it</td>
</tr>
<tr>
<td class="address-1"><span id="49253"></span>C065</td>
<td class="instruction">LD HL,$AA77</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the offset of positions for debris 3</td>
</tr>
<tr>
<td class="address-1"><span id="49256"></span>C068</td>
<td class="instruction">CALL <a href="49758.html">$C25E</a></td>
<td class="comment-1" rowspan="1">Handle debris movement and draw it</td>
</tr>
<tr>
<td class="address-1"><span id="49259"></span>C06B</td>
<td class="instruction">LD HL,$AA87</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the offset of positions for debris 4</td>
</tr>
<tr>
<td class="address-1"><span id="49262"></span>C06E</td>
<td class="instruction">CALL <a href="49758.html">$C25E</a></td>
<td class="comment-1" rowspan="1">Handle debris movement and draw it</td>
</tr>
<tr>
<td class="address-1"><span id="49265"></span>C071</td>
<td class="instruction">LD HL,$AA97</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the offset of positions for debris 5</td>
</tr>
<tr>
<td class="address-1"><span id="49268"></span>C074</td>
<td class="instruction">CALL <a href="49758.html">$C25E</a></td>
<td class="comment-1" rowspan="1">Handle debris movement and draw it</td>
</tr>
<tr>
<td class="address-1"><span id="49271"></span>C077</td>
<td class="instruction">LD HL,$AAA7</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the offset of positions for debris 6</td>
</tr>
<tr>
<td class="address-1"><span id="49274"></span>C07A</td>
<td class="instruction">CALL <a href="49758.html">$C25E</a></td>
<td class="comment-1" rowspan="1">Handle debris movement and draw it</td>
</tr>
<tr>
<td class="address-1"><span id="49277"></span>C07D</td>
<td class="instruction">INC (IX+$03)</td>
<td class="comment-1" rowspan="1">Increment explosion debris counter</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49280"></span>
<div class="comments">
<div class="paragraph">
Draw central explosion
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="49280"></span>C080</td>
<td class="instruction">LD A,(IX+$00)</td>
<td class="comment-1" rowspan="2">Set <a href="41544.html">A248</a> the x-pixel-position of the explosion</td>
</tr>
<tr>
<td class="address-1"><span id="49283"></span>C083</td>
<td class="instruction">LD ($A248),A</td>
</tr>
<tr>
<td class="address-1"><span id="49286"></span>C086</td>
<td class="instruction">LD A,(IX+$01)</td>
<td class="comment-1" rowspan="2">Set <a href="41545.html">A249</a> the x-pixel-position of the explosion</td>
</tr>
<tr>
<td class="address-1"><span id="49289"></span>C089</td>
<td class="instruction">LD ($A249),A</td>
</tr>
<tr>
<td class="address-1"><span id="49292"></span>C08C</td>
<td class="instruction">CALL <a href="48151.html">$BC17</a></td>
<td class="comment-1" rowspan="1">Draw random attribute color for explosion</td>
</tr>
<tr>
<td class="address-1"><span id="49295"></span>C08F</td>
<td class="instruction">LD L,(IX+$04)</td>
<td class="comment-1" rowspan="6">Increment the graphic data address for the explosion</td>
</tr>
<tr>
<td class="address-1"><span id="49298"></span>C092</td>
<td class="instruction">LD H,(IX+$05)</td>
</tr>
<tr>
<td class="address-1"><span id="49301"></span>C095</td>
<td class="instruction">LD DE,$0048</td>
</tr>
<tr>
<td class="address-1"><span id="49304"></span>C098</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="address-1"><span id="49305"></span>C099</td>
<td class="instruction">LD (IX+$04),L</td>
</tr>
<tr>
<td class="address-1"><span id="49308"></span>C09C</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49311"></span>C09F</td>
<td class="instruction">DEC (IX+$0D)</td>
<td class="comment-1" rowspan="1">Decrement explosion counter</td>
</tr>
<tr>
<td class="address-1"><span id="49314"></span>C0A2</td>
<td class="instruction">JP NZ,<a href="48200.html#48476">$BD5C</a></td>
<td class="comment-1" rowspan="1">Jump to the next enemy configuration if not zero explosion has ended, configure gift: bubble, smartbomb or question</td>
</tr>
<tr>
<td class="address-1"><span id="49317"></span>C0A5</td>
<td class="instruction">LD HL,($A22C)</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to the address into the attribute file for the explosion</td>
</tr>
<tr>
<td class="address-1"><span id="49320"></span>C0A8</td>
<td class="instruction">LD DE,($A22E)</td>
<td class="comment-1" rowspan="1">Set <span class="register">DE</span> to the address into the attribute buffer for the explosion</td>
</tr>
<tr>
<td class="address-1"><span id="49324"></span>C0AC</td>
<td class="instruction">CALL <a href="48106.html">$BBEA</a></td>
<td class="comment-1" rowspan="1">Reset attribute color when explosion ended</td>
</tr>
<tr>
<td class="address-1"><span id="49327"></span>C0AF</td>
<td class="instruction">LD A,(IX+$00)</td>
<td class="comment-1" rowspan="2">x-pixel-position of sprite is less than 24?</td>
</tr>
<tr>
<td class="address-1"><span id="49330"></span>C0B2</td>
<td class="instruction">CP $18</td>
</tr>
<tr>
<td class="address-1"><span id="49332"></span>C0B4</td>
<td class="instruction">JP C,$C11C</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="49335"></span>C0B7</td>
<td class="instruction">LD (IX+$09),$FE</td>
<td class="comment-1" rowspan="1">Set Enemy configuration to energy bubble</td>
</tr>
<tr>
<td class="address-1"><span id="49339"></span>C0BB</td>
<td class="instruction">LD (IX+$0F),$10</td>
<td class="comment-1" rowspan="1">Set sprite height</td>
</tr>
<tr>
<td class="address-1"><span id="49343"></span>C0BF</td>
<td class="instruction">LD (IX+$0E),$02</td>
<td class="comment-1" rowspan="1">Set sprite width</td>
</tr>
<tr>
<td class="address-1"><span id="49347"></span>C0C3</td>
<td class="instruction">LD A,(IX+$01)</td>
<td class="comment-1" rowspan="3">Add 8 pixels to y-pixel-position</td>
</tr>
<tr>
<td class="address-1"><span id="49350"></span>C0C6</td>
<td class="instruction">ADD A,$08</td>
</tr>
<tr>
<td class="address-1"><span id="49352"></span>C0C8</td>
<td class="instruction">LD (IX+$01),A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49355"></span>
<div class="comments">
<div class="paragraph">
configure big bubble
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="49355"></span>C0CB</td>
<td class="instruction">LD (IX+$03),$00</td>
<td class="comment-1" rowspan="1">Reset configuration</td>
</tr>
<tr>
<td class="address-1"><span id="49359"></span>C0CF</td>
<td class="instruction">LD (IX+$06),$00</td>
<td class="comment-1" rowspan="1">Reset configuration</td>
</tr>
<tr>
<td class="address-1"><span id="49363"></span>C0D3</td>
<td class="instruction">LD (IX+$11),$64</td>
<td class="comment-1" rowspan="1">Set bubble counter to $64</td>
</tr>
<tr>
<td class="address-1"><span id="49367"></span>C0D7</td>
<td class="instruction">LD (IX+$10),$00</td>
<td class="comment-1" rowspan="1">Reset configuration</td>
</tr>
<tr>
<td class="address-1"><span id="49371"></span>C0DB</td>
<td class="instruction">LD HL,$8718</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to graphic data address for big bubble</td>
</tr>
<tr>
<td class="address-1"><span id="49374"></span>C0DE</td>
<td class="instruction">LD (IX+$12),L</td>
<td class="comment-1" rowspan="4">Set graphic data address for bubble</td>
</tr>
<tr>
<td class="address-1"><span id="49377"></span>C0E1</td>
<td class="instruction">LD (IX+$13),H</td>
</tr>
<tr>
<td class="address-1"><span id="49380"></span>C0E4</td>
<td class="instruction">LD (IX+$04),L</td>
</tr>
<tr>
<td class="address-1"><span id="49383"></span>C0E7</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49386"></span>C0EA</td>
<td class="instruction">LD A,(IX+$15)</td>
<td class="comment-1" rowspan="1">Check bubble type</td>
</tr>
<tr>
<td class="address-1"><span id="49389"></span>C0ED</td>
<td class="instruction">CP $FF</td>
<td class="comment-1" rowspan="1">No bubble?</td>
</tr>
<tr>
<td class="address-1"><span id="49391"></span>C0EF</td>
<td class="instruction">JP Z,$C11C</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="49394"></span>C0F2</td>
<td class="instruction">CALL <a href="42269.html">$A51D</a></td>
<td class="comment-1" rowspan="1">Set <span class="register">A</span> to a pseudo-random number</td>
</tr>
<tr>
<td class="address-1"><span id="49397"></span>C0F5</td>
<td class="instruction">CP $03</td>
<td class="comment-1" rowspan="1">is less than 3?</td>
</tr>
<tr>
<td class="address-1"><span id="49399"></span>C0F7</td>
<td class="instruction">JP C,$C123</td>
<td class="comment-1" rowspan="1">you are lucky, you got an smartbomb</td>
</tr>
<tr>
<td class="address-1"><span id="49402"></span>C0FA</td>
<td class="instruction">CP $06</td>
<td class="comment-1" rowspan="1">is less than 6?</td>
</tr>
<tr>
<td class="address-1"><span id="49404"></span>C0FC</td>
<td class="instruction">JP C,$C12D</td>
<td class="comment-1" rowspan="1">you are lucky, you got a question mark (random gift)</td>
</tr>
<tr>
<td class="address-1"><span id="49407"></span>C0FF</td>
<td class="instruction">LD A,(IX+$15)</td>
<td class="comment-1" rowspan="2">is bubble type big?</td>
</tr>
<tr>
<td class="address-1"><span id="49410"></span>C102</td>
<td class="instruction">OR A</td>
</tr>
<tr>
<td class="address-1"><span id="49411"></span>C103</td>
<td class="instruction">JP NZ,<a href="48200.html#48476">$BD5C</a></td>
<td class="comment-1" rowspan="1">Jump if so and process next object</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49414"></span>
<div class="comments">
<div class="paragraph">
configure small bubble
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="49414"></span>C106</td>
<td class="instruction">LD HL,$87D8</td>
<td class="comment-1" rowspan="1">Set <span class="register">HL</span> to graphic data for small bubble</td>
</tr>
<tr>
<td class="address-1"><span id="49417"></span>C109</td>
<td class="instruction">LD (IX+$12),L</td>
<td class="comment-1" rowspan="2">Set graphic data for the bubble</td>
</tr>
<tr>
<td class="address-1"><span id="49420"></span>C10C</td>
<td class="instruction">LD (IX+$13),H</td>
</tr>
<tr>
<td class="address-1"><span id="49423"></span>C10F</td>
<td class="instruction">LD (IX+$11),$8C</td>
<td class="comment-1" rowspan="1">Set bubble counter to $8C</td>
</tr>
<tr>
<td class="address-1"><span id="49427"></span>C113</td>
<td class="instruction">LD (IX+$04),L</td>
<td class="comment-1" rowspan="2">Set graphic data for the bubble</td>
</tr>
<tr>
<td class="address-1"><span id="49430"></span>C116</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49433"></span>C119</td>
<td class="instruction">JP <a href="48200.html#48476">$BD5C</a></td>
<td class="comment-1" rowspan="1">Jump to the next enemy configuration</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49436"></span>
<div class="comments">
<div class="paragraph">
configure no bubble
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49436"></span>C11C</td>
<td class="instruction">LD (IX+$0C),$00</td>
<td class="comment-1" rowspan="1">Set object live/visibility to dead/not visible</td>
</tr>
<tr>
<td class="address-1"><span id="49440"></span>C120</td>
<td class="instruction">JP <a href="48200.html#48476">$BD5C</a></td>
<td class="comment-1" rowspan="1">Jump to the next enemy configuration</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49443"></span>
<div class="comments">
<div class="paragraph">
configure smartbomb
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49443"></span>C123</td>
<td class="instruction">LD (IX+$09),$FD</td>
<td class="comment-1" rowspan="1">Set object type to smartbomb</td>
</tr>
<tr>
<td class="address-1"><span id="49447"></span>C127</td>
<td class="instruction">LD HL,$8BA0</td>
<td class="comment-1" rowspan="1">Set graphic data for smartbomb</td>
</tr>
<tr>
<td class="address-1"><span id="49450"></span>C12A</td>
<td class="instruction">JP $C134</td>
<td class="comment-1" rowspan="1">Jump forward</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="49453"></span>
<div class="comments">
<div class="paragraph">
configure question
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="49453"></span>C12D</td>
<td class="instruction">LD (IX+$09),$FC</td>
<td class="comment-1" rowspan="1">Set object type to question</td>
</tr>
<tr>
<td class="address-1"><span id="49457"></span>C131</td>
<td class="instruction">LD HL,$8BC0</td>
<td class="comment-1" rowspan="1">Set graphic data for question</td>
</tr>
<tr>
<td class="address-2"><span id="49460"></span>C134</td>
<td class="instruction">LD (IX+$04),L</td>
<td class="comment-1" rowspan="2">Copy address to object configuration</td>
</tr>
<tr>
<td class="address-1"><span id="49463"></span>C137</td>
<td class="instruction">LD (IX+$05),H</td>
</tr>
<tr>
<td class="address-1"><span id="49466"></span>C13A</td>
<td class="instruction">LD (IX+$02),$01</td>
<td class="comment-1" rowspan="1">Set sprite to reverse</td>
</tr>
<tr>
<td class="address-1"><span id="49470"></span>C13E</td>
<td class="instruction">JP <a href="48200.html#48476">$BD5C</a></td>
<td class="comment-1" rowspan="1">Jump to the next enemy configuration</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="48971.html">BF4B</a>
</td>
<td class="up">Up: <a href="../maps/all.html#48975">Map</a></td>
<td class="next">
Next: <a href="49473.html">C141</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Rex (Side B) RAM disassembly 20211106</div>
<div class="copyright">&#169; 1988 Martech Games Ltd. &#169; 2021 Andreu Font.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.5.</div>
</footer>
</body>
</html>